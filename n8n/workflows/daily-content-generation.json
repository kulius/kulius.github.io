{
  "name": "Daily Multi-Category Content Generation",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "cronExpression": "0 8 * * *"
            }
          ]
        }
      },
      "id": "schedule-trigger",
      "name": "Daily Trigger (08:00)",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [0, 200]
    },
    {
      "parameters": {
        "jsCode": "// å››å¤§é¡åˆ¥å®šç¾©\nconst categories = [\n  {\n    id: 'odoo',\n    name: 'Odoo å®¢è£½åŒ–é–‹ç™¼',\n    slug: 'odoo',\n    tags: ['Odoo', 'ERP', 'å®¢è£½åŒ–'],\n    prompt: 'è«‹æ’°å¯«ä¸€ç¯‡é—œæ–¼ Odoo ERP å®¢è£½åŒ–é–‹ç™¼çš„æŠ€è¡“æ–‡ç« ï¼Œå¯ä»¥åŒ…å«æ¨¡çµ„é–‹ç™¼ã€API æ•´åˆã€å·¥ä½œæµç¨‹è‡ªå‹•åŒ–ç­‰ä¸»é¡Œã€‚'\n  },\n  {\n    id: 'ai',\n    name: 'AI æ™ºæ…§æ‡‰ç”¨',\n    slug: 'ai',\n    tags: ['AI', 'Claude', 'LLM'],\n    prompt: 'è«‹æ’°å¯«ä¸€ç¯‡é—œæ–¼ AI æ‡‰ç”¨çš„æŠ€è¡“æ–‡ç« ï¼Œå¯ä»¥åŒ…å« Claudeã€ChatGPTã€Gemini ç­‰å·¥å…·çš„å¯¦éš›æ‡‰ç”¨æ¡ˆä¾‹ã€‚'\n  },\n  {\n    id: 'dt',\n    name: 'ä¼æ¥­æ•¸ä½è½‰å‹',\n    slug: 'dt',\n    tags: ['æ•¸ä½è½‰å‹', 'ERP', 'ä¼æ¥­ç®¡ç†'],\n    prompt: 'è«‹æ’°å¯«ä¸€ç¯‡é—œæ–¼ä¼æ¥­æ•¸ä½è½‰å‹çš„ç­–ç•¥æ–‡ç« ï¼Œå¯ä»¥åŒ…å« ERP å°å…¥ã€æµç¨‹å„ªåŒ–ã€çµ„ç¹”è®Šé©ç­‰ä¸»é¡Œã€‚'\n  },\n  {\n    id: 'dev',\n    name: 'å…¶ä»–é–‹ç™¼',\n    slug: 'dev',\n    tags: ['LINE', 'Svelte', 'Webé–‹ç™¼'],\n    prompt: 'è«‹æ’°å¯«ä¸€ç¯‡é—œæ–¼ LINE Botã€LIFFã€Svelte æˆ–å…¶ä»– Web é–‹ç™¼çš„æŠ€è¡“æ–‡ç« ã€‚'\n  }\n];\n\n// æ ¹æ“šæ—¥æœŸè¼ªæ›¿é¡åˆ¥\nconst today = new Date();\nconst dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));\nconst categoryIndex = dayOfYear % categories.length;\nconst selectedCategory = categories[categoryIndex];\n\n// ç”Ÿæˆæ—¥æœŸå­—ä¸² (YYYY-MM-DD)\nconst dateStr = today.toISOString().split('T')[0];\n\nreturn {\n  json: {\n    category: selectedCategory,\n    date: dateStr,\n    dateForFilename: dateStr.replace(/-/g, '')\n  }\n};"
      },
      "id": "select-category",
      "name": "Select Category",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [220, 200]
    },
    {
      "parameters": {
        "url": "https://hnrss.org/frontpage?count=5",
        "options": {}
      },
      "id": "rss-hn",
      "name": "RSS Hacker News",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [440, 50]
    },
    {
      "parameters": {
        "url": "https://dev.to/feed",
        "options": {}
      },
      "id": "rss-devto",
      "name": "RSS Dev.to",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [440, 200]
    },
    {
      "parameters": {
        "url": "https://www.odoo.com/blog/feed",
        "options": {}
      },
      "id": "rss-odoo",
      "name": "RSS Odoo",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [440, 350]
    },
    {
      "parameters": {
        "jsCode": "// å–å¾—é¡åˆ¥è³‡è¨Š\nconst categoryData = $('Select Category').item.json;\nconst category = categoryData.category;\nconst date = categoryData.date;\n\nreturn {\n  json: {\n    category: category,\n    date: date,\n    dateForFilename: categoryData.dateForFilename\n  }\n};"
      },
      "id": "merge-data",
      "name": "Merge Data",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 200]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key={{ $env.GEMINI_API_KEY }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \"ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„æŠ€è¡“éƒ¨è½æ ¼ä½œè€…ï¼Œè«‹æ ¹æ“šä»¥ä¸‹è¦æ±‚æ’°å¯«ä¸€ç¯‡ç¹é«”ä¸­æ–‡æŠ€è¡“æ–‡ç« ï¼š\\n\\né¡åˆ¥ï¼š{{ $json.category.name }}\\nä¸»é¡Œæç¤ºï¼š{{ $json.category.prompt }}\\n\\nè«‹æ’°å¯«ç´„ 800-1200 å­—çš„æ–‡ç« ï¼ŒåŒ…å«ï¼š\\n1. æ¸…æ¥šçš„æ¨™é¡Œï¼ˆå¸å¼•äººä½†å°ˆæ¥­ï¼‰\\n2. ç°¡çŸ­çš„æè¿°ï¼ˆ50-100å­—ï¼‰\\n3. æœ‰æ·±åº¦çš„æŠ€è¡“å…§å®¹\\n4. å¯¦éš›çš„ç¨‹å¼ç¢¼ç¯„ä¾‹ï¼ˆå¦‚é©ç”¨ï¼‰\\n5. çµè«–èˆ‡å»ºè­°\\n\\nè¼¸å‡ºæ ¼å¼å¿…é ˆæ˜¯ Markdownï¼Œfrontmatter æ ¼å¼å¦‚ä¸‹ï¼š\\n---\\ntitle: \\\"æ–‡ç« æ¨™é¡Œ\\\"\\ndescription: \\\"æ–‡ç« æè¿°\\\"\\npublished: {{ $json.date }}\\ntags: {{ JSON.stringify($json.category.tags) }}\\ncategory: \\\"{{ $json.category.id }}\\\"\\nauthor: \\\"è˜‡å‹ƒä»»\\\"\\n---\\n\\nï¼ˆæ–‡ç« å…§å®¹ï¼‰\"\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"temperature\": 0.7,\n    \"topK\": 40,\n    \"topP\": 0.95,\n    \"maxOutputTokens\": 4096\n  }\n}",
        "options": {}
      },
      "id": "gemini-generate",
      "name": "Gemini Generate",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [880, 200]
    },
    {
      "parameters": {
        "jsCode": "// è§£æ Gemini å›æ‡‰\nconst response = $input.item.json;\nconst categoryData = $('Merge Data').item.json;\n\n// å–å¾—ç”Ÿæˆçš„æ–‡ç« å…§å®¹\nlet content = response.candidates?.[0]?.content?.parts?.[0]?.text || '';\n\n// æ¸…ç†å…§å®¹ï¼ˆç§»é™¤å¯èƒ½çš„ markdown ç¨‹å¼ç¢¼å€å¡Šæ¨™è¨˜ï¼‰\ncontent = content.replace(/^```markdown\\n?/i, '').replace(/\\n?```$/i, '').trim();\n\n// ç”Ÿæˆæª”æ¡ˆåç¨± (slug)\nconst slug = `${categoryData.category.slug}-${categoryData.dateForFilename}-${Date.now().toString(36)}`;\n\n// æª”æ¡ˆè·¯å¾‘ (Twilight ä¸»é¡Œä½¿ç”¨ src/content/posts/)\nconst filePath = `src/content/posts/${slug}.md`;\n\nreturn {\n  json: {\n    slug: slug,\n    content: content,\n    path: filePath,\n    category: categoryData.category,\n    date: categoryData.date\n  }\n};"
      },
      "id": "prepare-content",
      "name": "Prepare Content",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1100, 200]
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://api.github.com/repos/kulius/kulius.github.io/contents/{{ $json.path }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"message\": \"Auto: æ–°å¢æ–‡ç«  {{ $json.slug }}\",\n  \"content\": \"{{ Buffer.from($json.content).toString('base64') }}\",\n  \"branch\": \"main\"\n}",
        "options": {}
      },
      "id": "github-create-file",
      "name": "GitHub Create File",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1320, 200],
      "credentials": {
        "httpHeaderAuth": {
          "name": "GitHub Token",
          "id": "github-token"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://graph.facebook.com/v19.0/{{ $env.FB_PAGE_ID }}/feed",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"message\": \"ğŸ“ æ–°æ–‡ç« ç™¼å¸ƒï¼\\n\\nã€{{ $json.category.name }}ã€‘\\n\\n{{ $json.content.match(/title: \\\"([^\\\"]+)\\\"/)?.[1] || 'æ–°æ–‡ç« ' }}\\n\\nğŸ‘‰ é–±è®€å…¨æ–‡ï¼šhttps://www.euptop.com/posts/{{ $json.slug }}/\",\n  \"link\": \"https://www.euptop.com/posts/{{ $json.slug }}/\",\n  \"access_token\": \"{{ $env.FB_PAGE_ACCESS_TOKEN }}\"\n}",
        "options": {}
      },
      "id": "facebook-post",
      "name": "Facebook Post",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1540, 200],
      "disabled": true
    },
    {
      "parameters": {
        "content": "## n8n æ¯æ—¥å…§å®¹ç”Ÿæˆå·¥ä½œæµç¨‹\n\n### æµç¨‹èªªæ˜\n1. **æ¯æ—¥ 08:00 è§¸ç™¼** - è‡ªå‹•åŸ·è¡Œ\n2. **é¡åˆ¥è¼ªæ›¿** - æ ¹æ“šæ—¥æœŸè‡ªå‹•é¸æ“‡é¡åˆ¥ï¼ˆOdoo â†’ AI â†’ æ•¸ä½è½‰å‹ â†’ å…¶ä»–é–‹ç™¼ï¼‰\n3. **è’é›†éˆæ„Ÿ** - å¾ RSS å–å¾—æœ€æ–°æŠ€è¡“æ–°è\n4. **AI ç”Ÿæˆ** - ä½¿ç”¨ Gemini API ç”Ÿæˆæ–‡ç« \n5. **GitHub ç™¼å¸ƒ** - è‡ªå‹•å»ºç«‹ PR æˆ–ç›´æ¥æ¨é€\n6. **ç¤¾ç¾¤åˆ†äº«** - ç™¼å¸ƒåˆ° Facebookï¼ˆå¯é¸ï¼‰\n\n### ç’°å¢ƒè®Šæ•¸\n- `GEMINI_API_KEY` - Gemini API é‡‘é‘°\n- `GITHUB_TOKEN` - GitHub Personal Access Token\n- `FB_PAGE_ID` - Facebook ç²‰å°ˆ IDï¼ˆå¯é¸ï¼‰\n- `FB_PAGE_ACCESS_TOKEN` - Facebook å­˜å–æ¬Šæ–ï¼ˆå¯é¸ï¼‰\n\n### æ³¨æ„äº‹é …\n- Twilight ä¸»é¡Œä½¿ç”¨ `published` è€Œé `pubDate`\n- æ–‡ç« è·¯å¾‘ï¼š`src/content/posts/`\n- ç¶²å€æ ¼å¼ï¼š`/posts/{slug}/`",
        "height": 520,
        "width": 400
      },
      "id": "sticky-note",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [-300, 0]
    }
  ],
  "connections": {
    "Daily Trigger (08:00)": {
      "main": [
        [
          {
            "node": "Select Category",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select Category": {
      "main": [
        [
          {
            "node": "RSS Hacker News",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Dev.to",
            "type": "main",
            "index": 0
          },
          {
            "node": "RSS Odoo",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS Hacker News": {
      "main": [
        [
          {
            "node": "Merge Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS Dev.to": {
      "main": [
        [
          {
            "node": "Merge Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RSS Odoo": {
      "main": [
        [
          {
            "node": "Merge Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Data": {
      "main": [
        [
          {
            "node": "Gemini Generate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Generate": {
      "main": [
        [
          {
            "node": "Prepare Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Content": {
      "main": [
        [
          {
            "node": "GitHub Create File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GitHub Create File": {
      "main": [
        [
          {
            "node": "Facebook Post",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner"
  },
  "pinData": {},
  "staticData": null,
  "tags": [],
  "triggerCount": 1
}
